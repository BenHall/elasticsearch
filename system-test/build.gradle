apply plugin: 'java'

dependencies {

    compile project(':scheduler')
    compile project(':elasticsearch-cloud-mesos')

    testCompile 'junit:junit:4.11'
    testCompile 'com.github.docker-java:docker-java:1.3.0'
    testCompile 'com.mashape.unirest:unirest-java:1.4.5'

}

task dockerComposeUp(type: Exec) {

    workingDir "${project.projectDir}/src/test/resources/mesos-es"

    commandLine 'docker-compose', 'up', '-d'

}

test.dependsOn(dockerComposeUp)

task dockerComposeKill(type: Exec) {

    workingDir "${project.projectDir}/src/test/resources/mesos-es"

    commandLine 'docker-compose', 'kill'

}

task dockerComposeRm(type: Exec) {

    workingDir "${project.projectDir}/src/test/resources/mesos-es"

    commandLine 'docker-compose', 'rm', '--force', '-v'

}

test.finalizedBy dockerComposeKill

dockerComposeKill.finalizedBy dockerComposeRm

// TODO: Configure test logs